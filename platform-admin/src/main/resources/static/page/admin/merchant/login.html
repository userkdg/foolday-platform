<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />

    <title>后台管理系统</title>
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="../css/animate.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/login.css" rel="stylesheet">
    <link href="../layui/css/layui.css" rel="stylesheet">
    <script>
        if (window.top !== window.self) {
            window.top.location = window.location;
        }
    </script>

</head>

<body class="signin">
    <div class="signinpanel">
        <div class="row">
            <div class="col-sm-12">
                <form style="text-align: center;" id="login-form">
                    <h3 class="no-margins">HAdmin模板-后台管理系统</h4>
                        <input name="username" type="text" class="form-control uname" value="" placeholder="用户名" />
                        <input name="password" type="password" class="form-control pword m-b" value="" placeholder="密码" />
                        <button class="btn btn-success btn-block" style="margin: 60px auto 0;width: 300px;">登录</button>
                </form>
            </div>
        </div>
        <div class="signup-footer">
            <div class="signup-center">
                &copy; 基于LAYUI的HADMIN的模板
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" charset="utf-8" src="../layui/layui.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.min.js"></script>
<script>
    layui.use("layer");

    $("#login-form").submit(function(e) {
        var params = $(this).serializeArray();
        var data = {};
        for(var i = 0;i < params.length;i++) {
            var dat = params[i];
            data[dat.name] = dat.value;
        }
        if(!data.username || !data.password) {
            layer.msg("填写项不能为空!")
            return false;
        }

        $.ajax({
            url: "/login",
            method: "post",
            data: {
                username: data.username,
                password: data.password
            },
            success: function (res) {
                if(!res) {
                    layer.msg("请求错误，请稍后重试");
                    return;
                } 
                if(res.errCode != 0) {
                    layer.msg(res.description || "登录失败!");
                    return;
                }
                location.replace("/admin/merchant/index.html");
            }
        })
        return false;
    });

</script>

</html>